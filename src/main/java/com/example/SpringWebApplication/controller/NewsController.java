package com.example.SpringWebApplication.controller;

import com.example.SpringWebApplication.service.NewsService;
import com.fasterxml.jackson.annotation.JsonValue;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.util.JSONPObject;
import com.fasterxml.jackson.databind.util.JSONWrappedObject;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import java.io.IOException;
import java.net.URL;
import java.util.*;

@RestController
public class NewsController {
    @Autowired
    private NewsService newsService;

    String profileVisitorJson  = "\"100002026998901-2\",\"100003335530454-2\",\"553543654-2\"," +
            "\"100001287671415-2\",\"537372457-2\",\"100027353001137-2\",\"100021814904428-2\",\"100000737307390-2\",\"100001705222457-2\"," +
            "\"594226293-2\",\"1046004448-2\",\"100008974505154-2\",\"1349968104-2\",\"515169745-2\",\"100000172985934-2\",\"100024571010783-2\"," +
            "\"100026957171178-2\",\"1604627311-2\",\"100010499946824-2\",\"100001738022056-2\",\"100001922109780-2\",\"100003569904922-2\",\"100028722736851-2\"," +
            "\"100000439264246-2\",\"690162639-2\",\"887620172-2\",\"100003009334429-2\",\"100003647328768-2\",\"100001379944805-2\",\"100024173715196-2\",\"1065502870-2\"," +
            "\"100008918712768-2\",\"1832751243-2\",\"100000958629198-2\",\"100001170901338-2\",\"100000777479105-2\",\"100016733353605-2\",\"100008413358806-2\"," +
        "\"100005804024511-2\",\"799469109-2\",\"100002253336992-2\",\"100007231778199-2\",\"100007279808982-2\",\"100001078091203-2\",\"100003236751012-2\"," +
        "\"100009457523465-2\",\"100005693115595-2\",\"100005962023424-2\",\"100008192082685-2\",\"100007785013651-2\",\"100009784087395-2\",\"100002301260627-2\"," +
        "\"100009400771522-2\",\"100002620635243-2\",\"100006900434020-2\",\"100002656795411-2\",\"100009159780199-2\",\"100001137958323-2\",\"1345539145-2\"," +
        "\"100008119512243-2\",\"100001489424537-2\",\"664343810-2\",\"100001667332747-2\",\"1672184932-2\",\"100000123477191-2\",\"100004925290430-2\",\"1230255162-2\"," +
        "\"100007266695100-2\",\"100003904310809-2\",\"100001241218301-2\",\"100002591037084-2\",\"100000687983094-2\",\"606992432-2\",\"100024845051427-2\",\"626135003-2\"," +
        "\"568761545-2\",\"100009319208632-2\",\"100009223125650-2\",\"527726148-2\",\"100000435074674-2\",\"100018187427965-2\",\"528073728-2\",\"100005147470364-2\"," +
        "\"699021865-2\",\"664371119-2\",\"100001270838261-2\",\"604585333-2\",\"100006684781634-2\",\"729471778-2\",\"100024007864179-2\",\"100002141154148-2\",\"1309875925-2\"," +
        "\"100009263190604-2\",\"100000464168298-2\",\"608129181-2\",\"100000322096395-2\",\"100003996236113-2\",\"627697101-2\",\"785265554-2\",\"701844231-2\",\"1096060986-2\"," +
        "\"100000358412939-2\",\"100027486463269-2\",\"100000755660390-2\",\"100007821483673-2\",\"541662756-2\",\"100003395547439-2\",\"100001061620270-2\",\"100001643838655-2\"," +
        "\"1346650357-2\",\"1210885243-2\",\"674616822-2\",\"100017298518777-2\",\"100015745211280-2\",\"100018745662353-2\",\"100021977820304-2\",\"740440887-2\"," +
        "\"1429527484-2\",\"100002051460723-2\",\"100001582956625-2\",\"100002942260387-2\",\"100000199689276-2\",\"100000814242683-2\",\"100001435757625-2\"," +
        "\"100000816556606-2\",\"100009985569236-2\",\"100000568632600-2\",\"100000534594681-2\",\"100001252742888-2\",\"100002420434033-2\",\"100002404670345-2\"," +
        "\"683557306-2\",\"100001123536696-2\",\"100002717136762-2\",\"100002933842142-2\",\"100025028761353-2\",\"100000859256267-2\",\"100001425718549-2\",\"1705555796-2\"," +
        "\"100001040641952-2\",\"100002416868507-2\",\"100000367340234-2\",\"100001765053595-2\",\"655682042-2\",\"100001098025342-2\",\"621158024-2\",\"100006493944730-2\"," +
        "\"100009161749611-2\",\"1030218924-2\",\"100002690291560-2\",\"769562137-2\",\"100000594587680-2\",\"100026101806473-2\",\"703424358-2\",\"100002347737476-2\"," +
        "\"1045541411-2\",\"632242003-2\",\"1243233134-2\",\"1154467134-2\",\"695983283-2\",\"100026652048617-2\",\"100004910084413-2\",\"551846142-2\",\"100000609818141-2\"," +
        "\"617713237-2\",\"100000983688760-2\",\"100001026705053-2\",\"542226823-2\",\"1396653703-2\",\"663172657-2\",\"100002193815670-2\",\"100005158359995-2\"," +
        "\"100006516466553-2\",\"100001474171008-2\",\"1484169610-2\",\"100019082775626-2\",\"100001652317787-2\",\"1070138374-2\",\"555017711-2\",\"1014338330-2\"," +
        "\"100000001518375-2\",\"100001162036565-2\",\"100009721866998-2\",\"100000136159470-2\",\"570722095-2\",\"100003025477931-2\",\"771629026-2\",\"1571739348-2\"," +
        "\"1332843012-2\",\"100000534740316-2\",\"100007104045929-2\",\"745878419-2\",\"100000405001342-2\",\"681986769-2\",\"100000425974703-2\",\"100001191886503-2\"," +
        "\"589153798-2\",\"100004053502036-2\",\"1039788795-2\",\"854324333-2\",\"606199142-2\",\"715888407-2\",\"1101707677-2\",\"100002734338925-2\",\"100003253138600-2\"," +
        "\"100000473015455-2\",\"100001102394643-2\",\"100001857344844-2\",\"100003496974136-2\",\"750144591-2\",\"100000430698257-2\",\"100021358209857-2\"," +
        "\"100001223150217-2\",\"100001096423369-2\",\"100000299570369-2\",\"100000735066347-2\",\"100001496384303-2\",\"100005988403965-2\",\"100000193443131-2\"," +
        "\"745021133-2\",\"1250541849-2\",\"100001838625946-2\",\"1355120733-2\",\"1660483666-2\",\"1402132271-2\",\"1571509443-2\",\"1452348276-2\",\"100022661899360-2\"," +
            "\"1112290868-2\",\"100001418484243-2\",\"100002106331699-2\",\"552646476-2\",\"100000177478192-2\",\"100008849520700-2\",\"1259543571-2\",\"1097860994-2\"," +
            "\"100001363089131-2\",\"570350195-2\",\"677236540-2\",\"648498550-2\",\"685183325-2\",\"100000384085790-2\",\"100024807047626-2\",\"100009180877482-2\"," +
            "\"100002577317749-2\",\"100001102427765-2\",\"100003502997382-2\",\"100004298149213-2\",\"1661703040-2\",\"100008909556225-2\",\"1015745185-2\",\"1113953816-2\"," +
            "\"100000149120956-2\",\"100000274389998-2\",\"100010434273624-2\",\"507722659-2\",\"1733184686-2\",\"100000729773123-2\",\"569428347-2\",\"1074218199-2\"," +
            "\"100001979602789-2\",\"1623176707-2\",\"100000485832592-2\",\"100001126806473-2\",\"100001753752017-2\",\"1001254034-2\",\"1504440913-2\",\"606626053-2\"," +
            "\"643604124-2\",\"100001604731668-2\",\"100003640275648-2\",\"1194668741-2\",\"525440036-2\",\"623901964-2\",\"630932747-2\",\"100003111258345-2\",\"570526815-2\"," +
            "\"100001269832751-2\",\"1585773775-2\",\"100001194541626-2\",\"100000282748134-2\",\"100001041352713-2\",\"100013548301392-2\",\"1090511042-2\"," +
            "\"100023456322468-2\",\"1109162341-2\",\"647953220-2\",\"525421834-2\",\"1235846058-2\",\"745109619-2\",\"100001393238967-2\",\"601544174-2\",\"549432474-2\"," +
            "\"1105750742-2\",\"100010326168083-2\",\"1303471128-2\",\"100002370744172-2\",\"780442967-2\",\"100002630773384-2\",\"100000287287602-2\",\"100000288076847-2\",\"100001101251040-2\",\"100010898015404-2\",\"755281662-2\",\"100001542833176-2\",\"100003196363466-2\",\"100003233101221-2\",\"690210852-2\",\"100001675313660-2\",\"571266706-2\",\"1080218353-2\",\"100000554244801-2\",\"697779315-2\",\"1052468496-2\",\"100000960473303-2\",\"100016791517755-2\",\"100000438603556-2\",\"100015381574256-2\",\"638419327-2\",\"100000009740051-2\",\"100002383406185-2\",\"100011778822220-2\",\"654388590-2\",\"557472751-2\",\"1588444628-2\",\"100001643183105-2\",\"1298988017-2\",\"1279806435-2\",\"540707903-2\",\"1245515887-2\",\"100000075047905-2\",\"100001963463915-2\",\"100018470239136-2\",\"1138870774-2\",\"100015761589550-2\",\"100003288821139-2\",\"100000424398094-2\",\"100001009518014-2\",\"1492344242-2\",\"555366902-2\",\"100024711752642-2\",\"1107464280-2\",\"702837713-2\",\"100001414931932-2\",\"1336222547-2\",\"507450131-2\",\"100021586043919-2\",\"100001709058336-2\",\"1708056942-2\",\"100014491246339-2\",\"1105613759-2\",\"618533529-2\",\"100026656607505-2\",\"100000996855672-2\",\"100028812314712-2\",\"100024518674243-2\",\"100000208177952-2\",\"1075568532-2\",\"100000788708809-2\",\"1059690075-2\",\"100000283659526-2\",\"100002954507085-2\",\"100002266764965-2\",\"626706885-2\",\"1400580621-2\",\"100004928625636-2\",\"100001479630746-2\",\"100016978170552-2\",\"782752151-2\",\"100003753119064-2\",\"100001786219205-2\",\"100004212090951-2\",\"100023525959560-2\",\"1615156254-2\",\"100013241656200-2\",\"100003626596546-2\",\"637691913-2\",\"100014554090356-2\",\"100015894549388-2\",\"1096133755-2\",\"698139668-2\",\"100002459462192-2\",\"100000797836245-2\",\"1198895574-2\",\"100002128638355-2\",\"100000901306594-2\",\"633712813-2\",\"100002962934883-2\",\"100000481160313-2\",\"100003298348572-2\",\"861050322-2\",\"1553006015-2\",\"746097629-2\",\"100001540860181-2\",\"1312081170-2\",\"1658424429-2\",\"100000814275422-2\",\"100010811471001-2\",\"100000903868659-2\",\"100003335530454-0\",\"100002026998901-0\",\"537372457-0\",\"553543654-0\",\"100000737307390-0\",\"594226293-0\",\"100008974505154-0\",\"1349968104-0\",\"100001287671415-0\",\"100027353001137-0\",\"515169745-0\",\"100000172985934-0\",\"100024571010783-0\",\"100026957171178-0\",\"1604627311-0\",\"100010499946824-0\",\"100001738022056-0\",\"100001922109780-0\",\"100021814904428-0\",\"100003569904922-0\",\"100028722736851-0\",\"100000439264246-0\",\"690162639-0\",\"100001705222457-0\",\"887620172-0\",\"100003009334429-0\",\"100003647328768-0\",\"100001379944805-0\",\"100024173715196-0\",\"1065502870-0\",\"100008918712768-0\",\"1046004448-0\",\"1832751243-0\",\"100000958629198-0\",\"100001170901338-0\",\"100000777479105-0\",\"100016733353605-0\",\"100008413358806-0\",\"100005804024511-0\",\"799469109-0\",\"100002253336992-0\",\"100007231778199-0\",\"100007279808982-0\",\"100001078091203-0\",\"100003236751012-0\",\"100009457523465-0\",\"100005693115595-0\",\"100005962023424-0\",\"100008192082685-0\",\"100009784087395-0\",\"100007785013651-0\",\"100002301260627-0\",\"100009400771522-0\",\"100002620635243-0\",\"100006900434020-0\",\"100002656795411-0\",\"100009159780199-0\",\"100001137958323-0\",\"1345539145-0\",\"100008119512243-0\",\"100001489424537-0\",\"664343810-0\",\"100001667332747-0\",\"1672184932-0\",\"100000123477191-0\",\"100004925290430-0\",\"1230255162-0\",\"100007266695100-0\",\"100003904310809-0\",\"100001241218301-0\",\"100002591037084-0\",\"100000687983094-0\",\"606992432-0\",\"100024845051427-0\",\"626135003-0\",\"568761545-0\",\"100009319208632-0\",\"100009223125650-0\",\"527726148-0\",\"100000435074674-0\",\"100018187427965-0\",\"528073728-0\",\"100005147470364-0\",\"699021865-0\",\"664371119-0\",\"100001270838261-0\",\"604585333-0\",\"100006684781634-0\",\"729471778-0\",\"100024007864179-0\",\"100002141154148-0\",\"1309875925-0\",\"100009263190604-0\"," +
            "\"100000464168298-0\",\"100000322096395-0\",\"608129181-0\",\"100003996236113-0\",\"627697101-0\",\"785265554-0\",\"701844231-0\"";

    @RequestMapping(value="/getTopStories", method = RequestMethod.GET, produces = "text/html")
    public ResponseEntity<String> getNews() throws Exception{
        return new ResponseEntity(getProfiles(), HttpStatus.OK);
    }

    private String getProfiles() throws IOException {
        String profileURLList = "<html><body>";
        profileVisitorJson = profileVisitorJson.replaceAll("\"", "");
        String[] profile = profileVisitorJson.split(",");
        System.out.println("profile length is :: " + profile.length);
        int totalProfileViews = 0;
        for(int i=0; i<profile.length;i++){
            String profileURL = profile[i].split("-")[0];
            System.out.println(profile[i].split("-")[1]);
            int count = Integer.parseInt(profile[i].split("-")[1]);
            if (count > 0){
                totalProfileViews++;
                String url = "https://www.facebook.com/"+profileURL;
                profileURLList = profileURLList + "<a href=\"" + url + "\">https://www.facebook.com/"+profileURL + "</a><br>";
            }
        }
        profileURLList = profileURLList +  "Total Profile vies is " + totalProfileViews + "</body></html>";
       /* Map<String, String> profileMap = new ObjectMapper().readValue(profileVisitorJson, LinkedHashMap.class);
        profileMap.forEach((key, value) -> profileURLList.add("https://www.facebook.com/"+key));
        System.out.println(profileURLList);*/
        return profileURLList;
    }

}

